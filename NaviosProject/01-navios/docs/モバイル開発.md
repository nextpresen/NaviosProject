# モバイル開発

最終更新: 2026-02-16
対象: `/home/zer0/ドキュメント/NaviosProject/01-navios`

## 1. 方針（Web/モバイル併用）

- Webアプリ: **Leaflet** で閲覧中心
- モバイルアプリ: **Google Maps API** で投稿体験を強化
- 目的: コストを抑えつつ、投稿時の利便性を最大化する

## 2. 設計ルール（破綻しないための前提）

1. DBの真実は `latitude` / `longitude`
- 緯度経度を唯一のソースにする
- `place_name` / `address_label` は表示用ラベルとして扱う
- Web/モバイルの地図SDKが異なってもピン位置は一致する

2. 検索機能はモバイルに寄せてよい
- モバイル投稿時に Google Places 検索を使う
- 保存は `lat/lng + place_name`（必要に応じて `address_label`）
- Web側は「閲覧中心」でも運用可能

3. Webには「Googleマップで開く」リンクを必ず付ける
- ピン詳細に外部リンクを追加
- ルート確認や現地移動の不安を減らす
- API課金なしでUXを強化できる

## 3. 推奨技術構成（Linux + Ubuntu）

### 3.1 モバイル基盤
- `React Native + Expo + TypeScript`
- 地図: `react-native-maps`（AndroidはGoogle Maps）
- 理由: 既存のTypeScript資産を活かしやすく、Ubuntuでも開発しやすい

### 3.2 バックエンド連携
- 既存の Navios API / Supabase を共通利用
- 保存データの契約はWebと統一（`lat/lng`中心）

### 3.3 開発環境（Ubuntu）
- Node.js LTS
- JDK 17
- Android Studio（SDK/Emulator）
- Expo CLI / EAS Build（将来iOSビルドにも対応）

## 4. 実装ロードマップ（最短）

### Step A: Webは現状維持 + 微調整
- ピン詳細に `place_name` / `address_label` を表示
- 「Googleマップで開く」ボタンを追加

### Step B: モバイル投稿専用アプリを作る
- 現在地取得
- Googleマップ表示 + ピン配置（ドラッグ微調整）
- Places検索（入力 -> 候補 -> 確定）
- Supabaseへ投稿データをINSERT
- まずは社内運用（非公開）で開始してよい

## 5. コスト設計

- Web閲覧をLeafletにすることでGoogle地図表示コストを抑制
- 課金増加ポイントは主に Places検索
- 投稿専用（運営中心）なら利用回数を読みやすく、予算管理しやすい
- Google Cloudは **Quota上限 + アラート** を必ず設定する

## 6. 将来拡張

- 将来ユーザー投稿を解放しても以下の構成で継続可能
- モバイル: Googleで投稿
- Web: Leafletで閲覧
- ただし解放時は `通報機能` と `レート制限` を必須実装

## 7. 現時点の推奨判断

- 最短で価値を出すなら、まずは **モバイル投稿専用** から着手
- 閲覧までモバイルに広げるのは、投稿運用が安定してからでよい
