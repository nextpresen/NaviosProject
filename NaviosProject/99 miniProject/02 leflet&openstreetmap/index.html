<!doctype html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Map Story Board</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;700&display=swap" rel="stylesheet">
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  >
  <style>
    :root {
      --bg-start: #f2efe7;
      --bg-end: #dbe4f0;
      --panel: rgba(255, 255, 255, 0.78);
      --line: rgba(15, 23, 42, 0.12);
      --text-main: #0f172a;
      --text-sub: #475569;
      --accent: #0f766e;
      --accent-2: #1d4ed8;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: "Space Grotesk", sans-serif;
      color: var(--text-main);
      background:
        radial-gradient(circle at 5% 10%, rgba(255, 255, 255, 0.88), transparent 45%),
        radial-gradient(circle at 92% 85%, rgba(186, 230, 253, 0.45), transparent 40%),
        linear-gradient(145deg, var(--bg-start), var(--bg-end));
      min-height: 100vh;
    }

    .shell {
      max-width: 1240px;
      margin: 0 auto;
      padding: 20px 16px;
      display: grid;
      gap: 14px;
      grid-template-rows: auto 1fr;
      min-height: 100vh;
    }

    .topbar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      padding: 14px 16px;
      border: 1px solid var(--line);
      background: var(--panel);
      backdrop-filter: blur(12px);
      border-radius: 18px;
      box-shadow: 0 10px 22px rgba(15, 23, 42, 0.08);
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .brand-dot {
      width: 12px;
      height: 12px;
      border-radius: 999px;
      background: linear-gradient(135deg, var(--accent), var(--accent-2));
      box-shadow: 0 0 0 6px rgba(15, 118, 110, 0.12);
      animation: pulse 2.2s infinite;
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.15); }
    }

    .layout {
      display: grid;
      gap: 14px;
      grid-template-columns: 320px 1fr;
      min-height: 0;
    }

    .panel {
      border: 1px solid var(--line);
      background: var(--panel);
      backdrop-filter: blur(10px);
      border-radius: 18px;
      box-shadow: 0 12px 25px rgba(15, 23, 42, 0.08);
      overflow: hidden;
      min-height: 0;
    }

    .panel-body {
      padding: 12px;
      overflow: auto;
      height: 100%;
      scrollbar-width: thin;
    }

    .post-card {
      width: 100%;
      border: 1px solid rgba(148, 163, 184, 0.28);
      border-radius: 14px;
      background: rgba(255, 255, 255, 0.92);
      margin-bottom: 10px;
      overflow: hidden;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .post-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 16px rgba(15, 23, 42, 0.09);
    }

    .map-wrap {
      position: relative;
      min-height: 0;
      border-radius: 18px;
      overflow: hidden;
      border: 1px solid var(--line);
      box-shadow: 0 18px 30px rgba(15, 23, 42, 0.12);
    }

    #map {
      width: 100%;
      height: calc(100vh - 126px);
      min-height: 500px;
    }

    .map-overlay {
      position: absolute;
      z-index: 1000;
      left: 14px;
      right: 14px;
      top: 14px;
      display: flex;
      justify-content: space-between;
      gap: 8px;
      pointer-events: none;
    }

    .map-note,
    .map-style {
      pointer-events: auto;
      border: 1px solid rgba(148, 163, 184, 0.35);
      background: rgba(255, 255, 255, 0.92);
      border-radius: 999px;
      padding: 7px 12px;
      font-size: 12px;
      color: var(--text-sub);
      backdrop-filter: blur(8px);
    }

    .style-buttons {
      display: flex;
      gap: 6px;
      margin-left: 8px;
    }

    .style-button {
      border: 1px solid rgba(100, 116, 139, 0.4);
      border-radius: 999px;
      padding: 4px 10px;
      font-size: 11px;
      font-weight: 700;
      color: #334155;
      background: rgba(255, 255, 255, 0.9);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .style-button.active {
      background: #0f172a;
      color: white;
      border-color: #0f172a;
    }

    .map-marker {
      width: 16px;
      height: 16px;
      border-radius: 999px;
      background: linear-gradient(135deg, #0f766e, #2563eb);
      border: 2px solid #ffffff;
      box-shadow: 0 0 0 8px rgba(37, 99, 235, 0.18);
    }

    .leaflet-popup-content-wrapper {
      border-radius: 14px;
      box-shadow: 0 12px 22px rgba(15, 23, 42, 0.18);
    }

    .popup-box {
      width: 230px;
    }

    .popup-box img {
      width: 100%;
      height: 116px;
      object-fit: cover;
      border-radius: 10px;
      margin-bottom: 8px;
    }

    .popup-link {
      display: inline-block;
      text-decoration: none;
      border-radius: 8px;
      background: #0f172a;
      color: #fff;
      font-size: 12px;
      font-weight: 700;
      padding: 6px 10px;
      margin-top: 2px;
    }

    @media (max-width: 960px) {
      .layout {
        grid-template-columns: 1fr;
      }

      #map {
        height: 70vh;
        min-height: 420px;
      }
    }
  </style>
</head>
<body>
  <div class="shell">
    <header class="topbar">
      <div class="brand">
        <span class="brand-dot" aria-hidden="true"></span>
        <div>
          <p class="m-0 text-[11px] tracking-[0.18em] text-slate-500 uppercase">Map First UI</p>
          <h1 class="m-0 text-[22px] leading-none font-bold">HIOKI MAP BOARD</h1>
        </div>
      </div>
      <div class="text-right">
        <p class="m-0 text-xs text-slate-500">投稿機能は未実装</p>
        <p class="m-0 text-sm font-semibold">一覧内マップ 表示デモ</p>
      </div>
    </header>

    <div class="layout">
      <aside class="panel">
        <div class="px-4 pt-4 pb-2 border-b border-slate-200/80">
          <p class="m-0 text-xs text-slate-500">Posts</p>
          <h2 class="m-0 text-lg font-bold">場所一覧</h2>
        </div>
        <div id="postList" class="panel-body"></div>
      </aside>

      <section class="map-wrap">
        <div class="map-overlay">
          <div class="map-note">ピンを押してポップアップから詳細へ</div>
          <div class="map-style">
            地図デザイン
            <span class="style-buttons">
              <button class="style-button" data-style="voyager">Voyager</button>
              <button class="style-button" data-style="light">Light</button>
              <button class="style-button" data-style="dark">Dark</button>
            </span>
          </div>
        </div>
        <div id="map"></div>
      </section>
    </div>
  </div>

  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""
  ></script>
  <script>
    const samplePosts = [
      {
        id: "post-001",
        title: "吉利の景色メモ",
        address: "鹿児島県日置市日吉町吉利4364",
        lat: 31.573710,
        lng: 130.345154,
        date: "2026-02-14",
        imageUrl: "https://placehold.co/320x180/png?text=Yoshitoshi+Spot"
      },
      {
        id: "post-002",
        title: "近くの散歩ログ",
        address: "鹿児島県日置市日吉町付近",
        lat: 31.575100,
        lng: 130.348000,
        date: "2026-02-13",
        imageUrl: "https://placehold.co/320x180/png?text=Walk+Log"
      },
      {
        id: "post-003",
        title: "夕方チェックポイント",
        address: "鹿児島県日置市日吉町吉利エリア",
        lat: 31.571800,
        lng: 130.343000,
        date: "2026-02-12",
        imageUrl: "https://placehold.co/320x180/png?text=Evening+Point"
      }
    ];

    const map = L.map("map", { zoomControl: false }).setView([31.573710, 130.345154], 15);
    L.control.zoom({ position: "bottomright" }).addTo(map);

    const tileLayers = {
      voyager: L.tileLayer("https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png", {
        maxZoom: 20,
        attribution: "&copy; OpenStreetMap contributors &copy; CARTO"
      }),
      light: L.tileLayer("https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png", {
        maxZoom: 20,
        attribution: "&copy; OpenStreetMap contributors &copy; CARTO"
      }),
      dark: L.tileLayer("https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png", {
        maxZoom: 20,
        attribution: "&copy; OpenStreetMap contributors &copy; CARTO"
      })
    };

    let currentLayer = tileLayers.voyager;
    currentLayer.addTo(map);

    const markerIcon = L.divIcon({
      html: '<span class="map-marker"></span>',
      className: "",
      iconSize: [16, 16],
      iconAnchor: [8, 8],
      popupAnchor: [0, -10]
    });

    const markerById = {};

    samplePosts.forEach((post) => {
      const popupHtml = `
        <div class="popup-box">
          <img src="${post.imageUrl}" alt="${post.title}">
          <p style="margin:0 0 4px;font-size:14px;font-weight:700;">${post.title}</p>
          <p style="margin:0 0 7px;font-size:12px;color:#475569;">${post.address}</p>
          <a class="popup-link" href="detail.html?id=${post.id}">詳細を見る</a>
        </div>
      `;

      const marker = L.marker([post.lat, post.lng], { icon: markerIcon })
        .addTo(map)
        .bindPopup(popupHtml);

      markerById[post.id] = marker;
    });

    const postList = document.getElementById("postList");
    postList.innerHTML = samplePosts.map((post) => `
      <article class="post-card">
        <img src="${post.imageUrl}" alt="${post.title}" class="w-full h-28 object-cover">
        <div class="p-3">
          <p class="m-0 text-[11px] uppercase tracking-wider text-slate-500">${post.date}</p>
          <h3 class="m-0 mt-1 text-sm font-bold">${post.title}</h3>
          <p class="m-0 mt-1 text-xs text-slate-600">${post.address}</p>
          <div class="mt-2 flex gap-2">
            <button class="focus-btn text-xs font-bold rounded-md border border-slate-300 px-2 py-1" data-id="${post.id}">地図で見る</button>
            <a href="detail.html?id=${post.id}" class="text-xs font-bold rounded-md bg-slate-900 text-white px-2 py-1 no-underline">詳細</a>
          </div>
        </div>
      </article>
    `).join("");

    document.querySelectorAll(".focus-btn").forEach((button) => {
      button.addEventListener("click", () => {
        const marker = markerById[button.dataset.id];
        const point = marker.getLatLng();
        map.flyTo(point, 17, { duration: 0.8 });
        marker.openPopup();
      });
    });

    const styleButtons = document.querySelectorAll(".style-button");
    const setMapStyle = (style) => {
      map.removeLayer(currentLayer);
      currentLayer = tileLayers[style];
      currentLayer.addTo(map);
      styleButtons.forEach((button) => {
        button.classList.toggle("active", button.dataset.style === style);
      });
    };

    styleButtons.forEach((button) => {
      button.addEventListener("click", () => setMapStyle(button.dataset.style));
    });

    setMapStyle("voyager");
  </script>
</body>
</html>
